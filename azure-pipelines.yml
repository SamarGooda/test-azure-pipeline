trigger:
- main
pool:
    vmImage: 'ubuntu-latest'

steps:
- script: echo Hello, world!
  displayName: 'Run a one-line script'


- task: ms-devlabs.custom-terraform-tasks.custom-terraform-installer-task.TerraformInstaller@0
  displayName: 'Install Terraform '

- task: ms-devlabs.custom-terraform-tasks.custom-terraform-release-task.TerraformTaskV1@0
  displayName: 'Terraform init'
  inputs:
    provider: aws
    backendServiceAWS: 'Test2-azure-pipeline'
    backendAWSBucketName: 'test-aws-samar'
    backendAWSKey: terraform.tfstat

- task: ms-devlabs.custom-terraform-tasks.custom-terraform-release-task.TerraformTaskV1@0
  displayName: 'Terraform plan'
  inputs:
    provider: aws
    command: plan
    environmentServiceNameAWS: 'Test2-azure-pipeline'
    backendServiceAWS: 'Test2-azure-pipeline'
    backendAWSBucketName: 'test-aws-samar'
    backendAWSKey: terraform.tfstat


- task: ms-devlabs.custom-terraform-tasks.custom-terraform-release-task.TerraformTaskV1@0
  displayName: 'Terraform apply'
  inputs:
    provider: aws
    command: apply
    environmentServiceNameAWS: 'Test2-azure-pipeline'
    backendServiceAWS: 'Test2-azure-pipeline'
    backendAWSBucketName: 'test-aws-samar'
    backendAWSKey: terraform.tfstat
